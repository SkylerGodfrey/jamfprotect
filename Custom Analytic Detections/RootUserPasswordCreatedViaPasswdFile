# RootUserPasswordCreatedViaPasswdFile
#
# This Analytic predicate may be used to report on a root user password being set via the /etc/passwd file.
# This detection functions by monitoring for the /etc/passwd file being created or modified with an entry containing a string beginning with 'root:'.
#
# Analytic Predicate:

$event.path MATCHES[cd] "/etc/passwd" AND (($event.isNewFile == 1 OR $event.isModified == 1)) AND FUNCTION($event.file, "newDelimitedEntries:comments:" , ".newlines", "#").@count > 0 AND FUNCTION($event.file, "newDelimitedEntries:comments:" , ".newlines", "#")[0] BEGINSWITH "root:"

# Required Analytic Configuration:

Sensor Event Type: GPFSEvent
Level: 0

# Recommended Analytic Configuration:
Actions: Alert
